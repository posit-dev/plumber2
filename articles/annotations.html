<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Annotations reference • plumber2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="annotations_files/libs/quarto-html/popper.min.js"></script><script src="annotations_files/libs/quarto-html/tippy.umd.min.js"></script><link href="annotations_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="annotations_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Annotations reference">
<meta property="og:image" content="https://posit-dev.github.io/plumber2/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">plumber2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/plumber.html">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-learn-plumber-" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Learn plumber2</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-learn-plumber-">
<li><a class="dropdown-item" href="../articles/introduction.html">1. Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/routing-and-input.html">2. Routing &amp; Input</a></li>
    <li><a class="dropdown-item" href="../articles/rendering-output.html">3. Rendering output</a></li>
    <li><a class="dropdown-item" href="../articles/execution-model.html">4. Runtime</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>5. Hosting (TBD)</h6></li>
    <li><a class="dropdown-item" href="../articles/programmatic-usage.html">6. Programmatic usage</a></li>
    <li><a class="dropdown-item" href="../articles/annotations.html">7. Annotation Reference</a></li>
    <li><a class="dropdown-item" href="../articles/security.html">8. Security</a></li>
    <li><a class="dropdown-item" href="../articles/tips-and-tricks.html">9. Tips &amp; Tricks</a></li>
    <li><a class="dropdown-item" href="../articles/migration.html">10. Migration</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/posit-dev/plumber2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Annotations reference</h1>




      <small class="dont-index">Source: <a href="https://github.com/posit-dev/plumber2/blob/main/vignettes/annotations.qmd" class="external-link"><code>vignettes/annotations.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <section class="level2"><h2 id="annotations">Annotations<a class="anchor" aria-label="anchor" href="#annotations"></a>
</h2>
<p>Annotations are specially-structured comments used in your plumber file to create an API. A full annotation line starts with <code>#*</code>, then the annotation keyword <code>@...</code>, any number of space characters followed by the content. If you wish to use the annotation to document your API file but don’t want any OpenAPI documentation to be generated you can use <code>@noDoc</code> tag which works much like roxygens <code>@noRd</code>.</p>
</section><section class="level2"><h2 id="annotation-settings">Annotation settings<a class="anchor" aria-label="anchor" href="#annotation-settings"></a>
</h2>
<p>A few annotations modify how the file is parsed and interpreted. These must all appear in the first block of the file (in the case of <code>@roxygenPrefix</code> the first line).</p>
<section class="level3"><h3 id="use-roxygen-prefix">Use roxygen prefix<a class="anchor" aria-label="anchor" href="#use-roxygen-prefix"></a>
</h3>
<p>By default, plumber2 uses the <code>#*</code> prefix for its blocks to avoid clashing with roxygen comments. plumber (the old one) allowed either and while it is recommended to differentiate between roxygen and plumber2 annotations you can opt in to also understanding roxygen prefix.</p>
<blockquote>
<p>This tag <strong>must</strong> appear on the first line of the file to have an effect.</p>
</blockquote>
<table class="table caption-top">
<thead><tr class="header">
<th>Annotation</th>
<th>Argument</th>
<th>Description/References</th>
</tr></thead>
<tbody><tr class="odd">
<td><code>@roxygenPrefix</code></td>
<td>None</td>
<td>Turns on roxygen prefix for the file</td>
</tr></tbody>
</table>
<p>If you wish to always allow roxygen prefixes you can set the <code>plumber2.roxygenPrefix</code> option to <code>TRUE</code></p>
<section class="level5"><h5 id="annotations-example">Annotations example<a class="anchor" aria-label="anchor" href="#annotations-example"></a>
</h5>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#* @roxygenPrefix</span></span>
<span><span class="cn">NULL</span></span></code></pre></div>
</section><section class="level5"><h5 id="equivalent-programmatic-usage">Equivalent programmatic usage<a class="anchor" aria-label="anchor" href="#equivalent-programmatic-usage"></a>
</h5>
<p>There is no direct equivalent in programmatic usage as this pertains to the parsing of the plumber file.</p>
</section></section><section class="level3"><h3 id="specifying-route-name">Specifying route name<a class="anchor" aria-label="anchor" href="#specifying-route-name"></a>
</h3>
<p>By default, the name of the file (without extension) is used as the name for the route any handlers etc are attached to. However, you can change this by having a first block in your file with a <code>@routeName</code> tag specifying the name to use for all route specific blocks in the file. This also makes it possible to split out the specification of a single route among multiple files if it begins to grow unwieldy</p>
<table class="table caption-top">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 46%">
</colgroup>
<thead><tr class="header">
<th>Annotation</th>
<th>Argument</th>
<th>Description/References</th>
</tr></thead>
<tbody><tr class="odd">
<td><code>@routeName</code></td>
<td><code>name</code></td>
<td>Sets the name of the route to use for all blocks in the file</td>
</tr></tbody>
</table>
<section class="level5"><h5 id="annotations-example-1">Annotations example<a class="anchor" aria-label="anchor" href="#annotations-example-1"></a>
</h5>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#* @routeName main_route</span></span>
<span><span class="cn">NULL</span></span></code></pre></div>
</section><section class="level5"><h5 id="equivalent-programmatic-usage-1">Equivalent programmatic usage<a class="anchor" aria-label="anchor" href="#equivalent-programmatic-usage-1"></a>
</h5>
<p>There is no direct equivalent in programmatic usage as this pertains to the parsing of the plumber file. Any relevant function has a <code>route</code> argument where you can specify which route to add the given functionality to.</p>
</section></section><section class="level3"><h3 id="specifying-route-order">Specifying route order<a class="anchor" aria-label="anchor" href="#specifying-route-order"></a>
</h3>
<p>Route files are processed in alphanumerical order which influence the order in which their route is attached. You can modify the route order (but not the file processing order) using the <code>@routeOrder</code> tag. If multiple files have the same <code>@routeName</code> then the lowest <code>@routeOrder</code> value will be used. Any file without a <code>@routeOrder</code> tag will be added after those that do, using the default alphanumeric order.</p>
<table class="table caption-top">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 46%">
</colgroup>
<thead><tr class="header">
<th>Annotation</th>
<th>Argument</th>
<th>Description/References</th>
</tr></thead>
<tbody><tr class="odd">
<td><code>@routeOrder</code></td>
<td><code>order</code></td>
<td>Sets the order in which routes are added to the api. Lower values means earlier position</td>
</tr></tbody>
</table>
<section class="level5"><h5 id="annotations-example-2">Annotations example<a class="anchor" aria-label="anchor" href="#annotations-example-2"></a>
</h5>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#* @routeOrder 3</span></span>
<span><span class="cn">NULL</span></span></code></pre></div>
</section><section class="level5"><h5 id="equivalent-programmatic-usage-2">Equivalent programmatic usage<a class="anchor" aria-label="anchor" href="#equivalent-programmatic-usage-2"></a>
</h5>
<p>You can programmatically control the location of a route you add with <code><a href="../reference/api_add_route.html">api_add_route()</a></code> using the <code>after</code> argument.</p>
</section></section><section class="level3"><h3 id="specifying-root-url-for-the-whole-file">Specifying root url for the whole file<a class="anchor" aria-label="anchor" href="#specifying-root-url-for-the-whole-file"></a>
</h3>
<p>Many annotations somehow references URL paths, either as the endpoint of a handler, or where to serve a shiny app from. You can set a root for the whole file which will be prepended to any relevant URL. In this way it is easy to move all functionality from a single file to a different location if necessary.</p>
<table class="table caption-top">
<thead><tr class="header">
<th>Annotation</th>
<th>Argument</th>
<th>Description/References</th>
</tr></thead>
<tbody><tr class="odd">
<td><code>@root</code></td>
<td><code>path</code></td>
<td>Sets the root of every URL path in the file</td>
</tr></tbody>
</table>
<section class="level5"><h5 id="annotations-example-3">Annotations example<a class="anchor" aria-label="anchor" href="#annotations-example-3"></a>
</h5>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#* @root /path/to/these/apis</span></span>
<span><span class="cn">NULL</span></span></code></pre></div>
</section><section class="level5"><h5 id="equivalent-programmatic-usage-3">Equivalent programmatic usage<a class="anchor" aria-label="anchor" href="#equivalent-programmatic-usage-3"></a>
</h5>
<p>You can programmatically set the root of a new route you add with <code><a href="../reference/api_add_route.html">api_add_route()</a></code> using the <code>root</code> argument.</p>
</section></section></section><section class="level2"><h2 id="global-annotations">Global annotations<a class="anchor" aria-label="anchor" href="#global-annotations"></a>
</h2>
<p>Global annotations are not related to any handler and should be placed in their own block. The block should be terminated by a <code>"_API"</code> expression. Instead of <code>@title</code> and <code>@description</code> you can also use the convention that the first line gives the title and any proceeding lines until the first tag gives the description.</p>
<table class="table caption-top">
<thead><tr class="header">
<th>Annotation</th>
<th>Argument</th>
<th>Description/References</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>@title</code></td>
<td><code>Title</code></td>
<td><a href="https://spec.openapis.org/oas/v3.0.3#info-object" class="external-link">Info Object</a></td>
</tr>
<tr class="even">
<td><code>@description</code></td>
<td><code>Description</code></td>
<td><a href="https://spec.openapis.org/oas/v3.0.3#info-object" class="external-link">Info Object</a></td>
</tr>
<tr class="odd">
<td><code>@tos</code></td>
<td><code>TOS link</code></td>
<td><a href="https://spec.openapis.org/oas/v3.0.3#info-object" class="external-link">Info Object</a></td>
</tr>
<tr class="even">
<td><code>@contact</code></td>
<td><code>Contact object</code></td>
<td><a href="https://spec.openapis.org/oas/v3.0.3#contact-object" class="external-link">Contact Object</a></td>
</tr>
<tr class="odd">
<td><code>@license</code></td>
<td><code>License object</code></td>
<td><a href="https://spec.openapis.org/oas/v3.0.3#license-object" class="external-link">License Object</a></td>
</tr>
<tr class="even">
<td><code>@version</code></td>
<td><code>Version</code></td>
<td><a href="https://spec.openapis.org/oas/v3.0.3#info-object" class="external-link">Info Object</a></td>
</tr>
<tr class="odd">
<td><code>@tag</code></td>
<td>
<code>Tag</code> <code>Description</code>
</td>
<td>Can be repeated to add multiple tags. Quote with ” or ’ to use non word character (like spaces) in <code>Tag</code>. <a href="https://spec.openapis.org/oas/v3.0.3#tag-object" class="external-link">Tag Object</a>
</td>
</tr>
<tr class="even">
<td><code>@noDoc</code></td>
<td>None</td>
<td>Don’t generate OpenAPI documentation from this block</td>
</tr>
</tbody>
</table>
<section class="level5"><h5 id="annotations-example-4">Annotations example<a class="anchor" aria-label="anchor" href="#annotations-example-4"></a>
</h5>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#* Sample Pet Store App</span></span>
<span><span class="co">#*</span></span>
<span><span class="co">#* This is a sample server for a pet store.</span></span>
<span><span class="co">#*</span></span>
<span><span class="co">#* @tos http://example.com/terms/</span></span>
<span><span class="co">#* @contact list(name = "API Support", url = "http://www.example.com/support", email = "support@example.com")</span></span>
<span><span class="co">#* @license list(name = "Apache 2.0", url = "https://www.apache.org/licenses/LICENSE-2.0.html")</span></span>
<span><span class="co">#* @version 1.0.1</span></span>
<span><span class="co">#* @tag pet Pets operations</span></span>
<span><span class="co">#* @tag toy Toys operations</span></span>
<span><span class="co">#* @tag "toy space" Toys operations</span></span>
<span><span class="st">"_API"</span></span></code></pre></div>
</section><section class="level5"><h5 id="equivalent-programmatic-usage-4">Equivalent programmatic usage<a class="anchor" aria-label="anchor" href="#equivalent-programmatic-usage-4"></a>
</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api.html">api</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/api_docs.html">api_doc_add</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/openapi.html">openapi</a></span><span class="op">(</span></span>
<span>    info <span class="op">=</span> <span class="fu"><a href="../reference/openapi.html">openapi_info</a></span><span class="op">(</span></span>
<span>      title <span class="op">=</span> <span class="st">"Sample Pet Store App"</span>,</span>
<span>      description <span class="op">=</span> <span class="st">"This is a sample server for a pet store."</span>,</span>
<span>      terms_of_service <span class="op">=</span> <span class="st">"http://example.com/terms/"</span>,</span>
<span>      contact <span class="op">=</span> <span class="fu"><a href="../reference/openapi.html">openapi_contact</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"API Support"</span>, url <span class="op">=</span> <span class="st">"http://www.example.com/support"</span>, email <span class="op">=</span> <span class="st">"support@example.com"</span><span class="op">)</span>,</span>
<span>      license <span class="op">=</span> <span class="fu"><a href="../reference/openapi.html">openapi_license</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Apache 2.0"</span>, url <span class="op">=</span> <span class="st">"https://www.apache.org/licenses/LICENSE-2.0.html"</span><span class="op">)</span>,</span>
<span>      version <span class="op">=</span> <span class="st">"1.0.1"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    tags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="../reference/openapi.html">openapi_tag</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"pet"</span>, description <span class="op">=</span> <span class="st">"Pets operations"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="../reference/openapi.html">openapi_tag</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"toy"</span>, description <span class="op">=</span> <span class="st">"Toys operations"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="../reference/openapi.html">openapi_tag</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"toy space"</span>, description <span class="op">=</span> <span class="st">"Toys operations"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</section></section><section class="level2"><h2 id="handler-annotations">Handler annotations<a class="anchor" aria-label="anchor" href="#handler-annotations"></a>
</h2>
<p>Handler annotation describe all aspects of a request handler and always proceeds a function which is considered the handler function. The following tags can be used in a handler block. The first line, unless it has a tag is considered the title of the handler and any proceeding lines until the first tag is considered a long-form description.</p>
<section class="level3"><h3 id="endpoint-block-annotations">Endpoint<a class="anchor" aria-label="anchor" href="#endpoint-block-annotations"></a>
</h3>
<table style="width:91%;" class="table">
<colgroup>
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 42%">
</colgroup>
<thead><tr>
<th>
<p>
Annotation
</p>
</th>
<th>
<p>
Argument
</p>
</th>
<th>
<p>
Description/References
</p>
</th>
</tr></thead>
<tbody>
<tr>
<td>
<p>
<code><span class="citation" data-cites="get">@get</span></code>, <code><span class="citation" data-cites="head">@head</span></code>, <code><span class="citation" data-cites="post">@post</span></code>, <code><span class="citation" data-cites="put">@put</span></code>, <code><span class="citation" data-cites="delete">@delete</span></code>, <code><span class="citation" data-cites="connect">@connect</span></code>, <code><span class="citation" data-cites="options">@options</span></code>, <code><span class="citation" data-cites="trace">@trace</span></code>, <code><span class="citation" data-cites="patch">@patch</span></code>, <code><span class="citation" data-cites="any">@any</span></code>
</p>
</td>
<td>
<p>
<code>Path</code>
</p>
</td>
<td>
<p>
<a href="./routing-and-input.html#endpoints">Endpoints</a>, <a href="./routing-and-input.html#dynamic-routes">Dynamic Routes</a>, <a href="./routing-and-input.html#typed-dynamic-routes">Typed Dynamic Routes</a>
</p>
</td>
</tr>
<tr>
<td>
<p>
<code><span class="citation" data-cites="header">@header</span></code>
</p>
</td>
<td>
<p>
None
</p>
</td>
<td>
<p>
Should the handler be attached to the header router
</p>
</td>
</tr>
<tr>
<td>
<p>
<code><span class="citation" data-cites="serializer">@serializer</span></code>
</p>
</td>
<td>
<p>
<code>Alias</code>[<code>{Args list]}</code>]
</p>
<p>
<code>Mime</code> <code>Function</code>
</p>
</td>
<td>
<p>
Some serializers accept arguments. See <a href="./rendering-output.html#serializers">serializers article</a> and <a href="https://www.rplumber.io/reference/serializers.html" class="external-link">serializers reference</a>. Aliases : <code>r paste0(“&lt;code&gt;”, registered_serializers(), “&lt;/code&gt;”, collapse = “,”)</code> from <a href="https://www.rplumber.io/reference/register_serializer.html" class="external-link"><code>registered_serializers()</code></a>.
</p>
</td>
</tr>
<tr>
<td>
<p>
<code><span class="citation" data-cites="serializerStrict">@serializerStrict</span></code>
</p>
</td>
<td>
<p>
None
</p>
</td>
<td>
<p>
Turn on strict content negotiation. By default, the first serializer is chosen if the client requests a response type that isnt supported. By using strict content negotiation a 406 response is sent if the requested response type is not available
</p>
</td>
</tr>
<tr>
<td>
<p>
<code><span class="citation" data-cites="parser">@parser</span></code>
</p>
</td>
<td>
<p>
<code>Alias</code>[<code>{Args list}</code>]
</p>
<p>
<code>Mime</code> <code>Function</code>
</p>
</td>
<td>
<p>
Some parsers accept arguments. See <a href="https://www.rplumber.io/reference/parsers.html" class="external-link">parsers reference</a>. Can be repeated to allow multiple parsers on the same endpoint. Aliases : <code>r paste0(“&lt;code&gt;”, registered_parsers(), “&lt;/code&gt;”, collapse = “,”)</code> from <a href="https://www.rplumber.io/reference/register_parser.html" class="external-link"><code>registered_parsers()</code></a>.
</p>
</td>
</tr>
<tr>
<td>
<p>
<code><span class="citation" data-cites="param">@param</span></code>, <code><span class="citation" data-cites="query">@query</span></code>, <code><span class="citation" data-cites="body">@body</span></code>
</p>
</td>
<td>
<p>
<code>Name</code>[<code>:Type</code>][<code>(Default)</code>][<code>*</code>][<code>Description</code>]
</p>
</td>
<td>
<p>
Adding an asterix indicates that the parameter is required. Can be repeated to define different parameters. If a single <code><span class="citation" data-cites="body">@body</span></code> tag is used the <code>Name</code> can be omitted to indicate that the body is not a named object but simply an instance of the given <code>Type</code>
</p>
</td>
</tr>
<tr>
<td>
<p>
<code><span class="citation" data-cites="response">@response</span></code>
</p>
</td>
<td>
<p>
<code>Status</code>[<code>:Type</code>] <code>Description</code>
</p>
</td>
<td>
<p>
Simple <a href="https://spec.openapis.org/oas/v3.0.3#response-object" class="external-link">Response object</a>. Can be repeated to define different responses.
</p>
</td>
</tr>
<tr>
<td>
<p>
<code><span class="citation" data-cites="download">@download</span></code>
</p>
</td>
<td>
<p>
[<code>Filename</code>]
</p>
</td>
<td>
<p>
Mark the response as something that should be downloaded, optionally setting a default filename for the file
</p>
</td>
</tr>
<tr>
<td>
<p>
<code><span class="citation" data-cites="tag">@tag</span></code>
</p>
</td>
<td>
<p>
<code>Tag</code>
</p>
</td>
<td>
<p>
Can be repeated to add multiple tags. Quote with or to use non word character (like spaces) in <code>Tag</code>. <a href="https://spec.openapis.org/oas/v3.0.3#operation-object" class="external-link">Tag field</a>
</p>
</td>
</tr>
<tr>
<td>
<p>
<code><span class="citation" data-cites="message">@message</span></code>
</p>
</td>
<td>
<p>
None
</p>
</td>
<td>
<p>
Marks the handler as a WebSocket message handler. No other tags will have an effect if this tag is present (except <code><span class="citation" data-cites="async">@async</span></code>)
</p>
</td>
</tr>
<tr>
<td>
<p>
<code><span class="citation" data-cites="async">@async</span></code>
</p>
</td>
<td>
<p>
[<code>engine</code>]
</p>
</td>
<td>
<p>
Marks the handler as running asynchronously. The default uses mirai, but a different registered engine can be specified as well
</p>
</td>
</tr>
<tr>
<td>
<p>
<code><span class="citation" data-cites="then">@then</span></code>
</p>
</td>
<td>
<p>
None
</p>
</td>
<td>
<p>
Chains the handler to the preceeding message or request handler if that handler is asynchronous
</p>
</td>
</tr>
<tr>
<td>
<p>
<code><span class="citation" data-cites="cors">@cors</span></code>
</p>
</td>
<td>
<p>
[<code>Origin</code>]
</p>
</td>
<td>
<p>
Add CORS to the endpoints in the handler. <code>Origin</code> can be a comma separated list of allowed origins
</p>
</td>
</tr>
<tr>
<td>
<p>
<code><span class="citation" data-cites="rip">@rip</span></code>
</p>
</td>
<td>
<p>
[<code>Allowed Site</code>]
</p>
</td>
<td>
<p>
Adds a resource isolation policy to the <code>get</code> endpoints in the handler. <code>Allowed Site</code> can be used to change the allowance level
</p>
</td>
</tr>
<tr>
<td>
<p>
<code><span class="citation" data-cites="noDoc">@noDoc</span></code>
</p>
</td>
<td>
<p>
None
</p>
</td>
<td>
<p>
Dont generate OpenAPI documentation from this block
</p>
</td>
</tr>
</tbody>
</table>
<section class="level4"><h4 id="more-details-on-type">More details on <code>Type</code>
<a class="anchor" aria-label="anchor" href="#more-details-on-type"></a>
</h4>
<p>Types are used to define API inputs and outputs. For path parameters they can be given both in <code>@param</code> and inside the handler path. If they are given both places they <strong>must</strong> be in agreement. For query and body parameters they are given in their respective <code>@query</code> and <code>@body</code> tags.</p>
<p>Some types can have a nested structure which is also supported, but the type spec can quickly become difficult to read the further you recurse so use with care</p>
<table class="table caption-top">
<colgroup>
<col style="width: 44%">
<col style="width: 55%">
</colgroup>
<thead><tr class="header">
<th>Type</th>
<th>OpenAPI</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>boolean</code></td>
<td><code>boolean</code></td>
</tr>
<tr class="even">
<td><code>number</code></td>
<td><code>number</code></td>
</tr>
<tr class="odd">
<td><code>integer</code></td>
<td><code>integer</code></td>
</tr>
<tr class="even">
<td><code>string</code></td>
<td><code>string</code></td>
</tr>
<tr class="odd">
<td><code>date</code></td>
<td>
<code>string</code> <code>format:date</code>
</td>
</tr>
<tr class="even">
<td><code>date-time</code></td>
<td>
<code>string</code> <code>format:date-time</code>
</td>
</tr>
<tr class="odd">
<td><code>byte</code></td>
<td>
<code>string</code> <code>format:byte</code>
</td>
</tr>
<tr class="even">
<td><code>binary</code></td>
<td>
<code>string</code> <code>format:binary</code>
</td>
</tr>
<tr class="odd">
<td><code>enum</code></td>
<td>
<code>string</code> <code>enum:|...|</code>
</td>
</tr>
<tr class="even">
<td><code>pattern</code></td>
<td>
<code>string</code> <code>pattern:|...|</code>
</td>
</tr>
<tr class="odd">
<td><code>[Type]</code></td>
<td>
<code>array</code> <code>items:type:Type</code>
</td>
</tr>
<tr class="even">
<td><code>{prop_name: Type, prop_name2: Type2}</code></td>
<td>
<code>object</code> <code>properties:prop_name:type:Type</code> <code>properties:prop_name2:type:Type2</code>
</td>
</tr>
</tbody>
</table>
<p>Types can have a default value, which is given in parentheses after the type specification, e.g. <code>integer(10)</code>. For objects and arrays you should use JSON notation to describe the default value (e.g. <code>[integer]([2, 6, 1])</code>).</p>
<p>For the <code>integer</code> and <code>number</code> types it is also possible to specify the lower and/or upper bounds of the value. This is done by putting these between <code>|</code> like so: <code>integer|3, 7|</code>. Omitting one of these will remove that bound requirement (e.g. <code>integer|,7|</code> only requires the input to be below or equal to 7). If combining this with a default value the range comes first (<code>integer|3,7|(5)</code>).</p>
<p>The <code>enum</code> type is a factor type and you must provide the valid values of the type in between <code>|</code>, separated by comma and an optional whitespace. The <code>pattern</code> type is a string type that must match the regular expression given between <code>|</code>.</p>
<p>The <code>date</code> and <code>date-time</code> types require the use of a specific format for the date or time described in <a href="https://datatracker.ietf.org/doc/html/rfc3339#section-5.6" class="external-link">RFC 3339, section 5.6</a>. The date must be given in full-date notation, e.g. <em>2017-07-21</em> while the date-time must be given in the date-time notation, e.g. <em>2017-07-21T17:32:28Z</em></p>
<p>parameters can be specified as optional or required in their type notation. Path parameters are always required so any setting is ignored for this. A parameter can be marked as required by adding a <code>*</code> suffix to the type description, e.g. <code>arg1:integer*</code> to indicate that <code>arg1</code> is required and an integer. A parameter cannot both be required and have a default value (for reasons of logic).</p>
<p>Apart from being used in the documentation of your API, the type information you provide for parameters will also be used to cast the incoming values to the correct type and add defaults if missing. Further, missing required parameters will result in an error. The response is not type checked so it is up to you to conform with the specification you provide.</p>
<section class="level5"><h5 id="annotations-example-5">Annotations example<a class="anchor" aria-label="anchor" href="#annotations-example-5"></a>
</h5>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#* @get /query/parameters</span></span>
<span><span class="co">#* @serializer text</span></span>
<span><span class="co">#* @query name:string*</span></span>
<span><span class="co">#* @query age:integer*</span></span>
<span><span class="kw">function</span><span class="op">(</span><span class="va">query</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s is %i years old"</span>, <span class="va">query</span><span class="op">$</span><span class="va">name</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">query</span><span class="op">$</span><span class="va">age</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#* @get /dyn/&lt;name:string&gt;/&lt;age:integer&gt;/route</span></span>
<span><span class="co">#* @serializer text</span></span>
<span><span class="co">#* @parser none</span></span>
<span><span class="co">#* @response 200:string A sentence</span></span>
<span><span class="kw">function</span><span class="op">(</span><span class="va">name</span>, <span class="va">age</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s is %i years old"</span>, <span class="va">name</span>, <span class="va">age</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#* Upload a file and return the object as an rds</span></span>
<span><span class="co">#*</span></span>
<span><span class="co">#* @post /upload_file</span></span>
<span><span class="co">#* @serializer rds</span></span>
<span><span class="co">#* @parser multi</span></span>
<span><span class="co">#* @body file:binary A file</span></span>
<span><span class="co">#* @download</span></span>
<span><span class="kw">function</span><span class="op">(</span><span class="va">body</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">body</span><span class="op">$</span><span class="va">file</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#* @message</span></span>
<span><span class="kw">function</span><span class="op">(</span><span class="va">message</span>, <span class="va">client_id</span>, <span class="va">server</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character</a></span><span class="op">(</span><span class="va">message</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">server</span><span class="op">$</span><span class="fu">log</span><span class="op">(</span><span class="st">"message"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">client_id</span>, <span class="st">" says "</span>, <span class="va">message</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="cn">NULL</span></span>
<span><span class="op">}</span></span></code></pre></div>
</section><section class="level5"><h5 id="equivalent-programmatic-usage-5">Equivalent programmatic usage<a class="anchor" aria-label="anchor" href="#equivalent-programmatic-usage-5"></a>
</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">text_handler</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">name</span>, <span class="va">age</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s is %i years old"</span>, <span class="va">name</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">qp_handler</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">query</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">text_handler</span><span class="op">(</span><span class="va">query</span><span class="op">$</span><span class="va">name</span>, <span class="va">query</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">file_handler</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">body</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">body</span><span class="op">$</span><span class="va">f</span></span>
<span><span class="op">}</span></span>
<span><span class="va">msg_handler</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">message</span>, <span class="va">client_id</span>, <span class="va">server</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character</a></span><span class="op">(</span><span class="va">message</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">server</span><span class="op">$</span><span class="fu">log</span><span class="op">(</span><span class="st">"message"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">client_id</span>, <span class="st">" says "</span>, <span class="va">message</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="cn">NULL</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="../reference/api.html">api</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/api_request_handlers.html">api_get</a></span><span class="op">(</span></span>
<span>    path <span class="op">=</span> <span class="st">"/query/parameters"</span>,</span>
<span>    handler <span class="op">=</span> <span class="va">qp_handler</span>,</span>
<span>    serializers <span class="op">=</span> <span class="fu"><a href="../reference/register_serializer.html">get_serializers</a></span><span class="op">(</span><span class="st">"text"</span><span class="op">)</span>,</span>
<span>    parsers <span class="op">=</span> <span class="fu"><a href="../reference/register_parser.html">get_parsers</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    doc <span class="op">=</span> <span class="fu"><a href="../reference/openapi.html">openapi_operation</a></span><span class="op">(</span></span>
<span>      parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="../reference/openapi.html">openapi_parameter</a></span><span class="op">(</span></span>
<span>          name <span class="op">=</span> <span class="st">"name"</span>,</span>
<span>          location <span class="op">=</span> <span class="st">"query"</span>,</span>
<span>          required <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          schema <span class="op">=</span> <span class="fu"><a href="../reference/openapi.html">openapi_schema</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        <span class="fu"><a href="../reference/openapi.html">openapi_parameter</a></span><span class="op">(</span></span>
<span>          name <span class="op">=</span> <span class="st">"age"</span>,</span>
<span>          location <span class="op">=</span> <span class="st">"query"</span>,</span>
<span>          required <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          schema <span class="op">=</span> <span class="fu"><a href="../reference/openapi.html">openapi_schema</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/api_request_handlers.html">api_get</a></span><span class="op">(</span></span>
<span>    path <span class="op">=</span> <span class="st">"/dyn/&lt;name:string&gt;/&lt;age:integer&gt;/route"</span>,</span>
<span>    handler <span class="op">=</span> <span class="va">text_handler</span>,</span>
<span>    serializers <span class="op">=</span> <span class="fu"><a href="../reference/register_serializer.html">get_serializers</a></span><span class="op">(</span><span class="st">"text"</span><span class="op">)</span>,</span>
<span>    doc <span class="op">=</span> <span class="fu"><a href="../reference/openapi.html">openapi_operation</a></span><span class="op">(</span></span>
<span>      responses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>         <span class="st">"200"</span> <span class="op">=</span> <span class="fu"><a href="../reference/openapi.html">openapi_response</a></span><span class="op">(</span></span>
<span>          description <span class="op">=</span> <span class="st">"A sentence"</span>,</span>
<span>          content <span class="op">=</span> <span class="fu"><a href="../reference/openapi.html">openapi_content</a></span><span class="op">(</span></span>
<span>            <span class="st">"text/plain"</span> <span class="op">=</span> <span class="fu"><a href="../reference/openapi.html">openapi_schema</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/api_request_handlers.html">api_post</a></span><span class="op">(</span></span>
<span>    path <span class="op">=</span> <span class="st">"/upload_file"</span>,</span>
<span>    handler <span class="op">=</span> <span class="va">file_handler</span>,</span>
<span>    serializers <span class="op">=</span> <span class="fu"><a href="../reference/register_serializer.html">get_serializers</a></span><span class="op">(</span><span class="st">"rds"</span><span class="op">)</span>,</span>
<span>    parsers <span class="op">=</span> <span class="fu"><a href="../reference/register_parser.html">get_parsers</a></span><span class="op">(</span><span class="st">"multi"</span><span class="op">)</span>,</span>
<span>    doc <span class="op">=</span> <span class="fu"><a href="../reference/openapi.html">openapi_operation</a></span><span class="op">(</span></span>
<span>      description <span class="op">=</span> <span class="st">"Upload an rds file and return the object"</span>,</span>
<span>      request_body <span class="op">=</span> <span class="fu"><a href="../reference/openapi.html">openapi_request_body</a></span><span class="op">(</span></span>
<span>        content <span class="op">=</span> <span class="fu"><a href="../reference/openapi.html">openapi_content</a></span><span class="op">(</span></span>
<span>          <span class="st">"multipart/form-data"</span> <span class="op">=</span> <span class="fu"><a href="../reference/openapi.html">openapi_schema</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/raw.html" class="external-link">raw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/api_message.html">api_message</a></span><span class="op">(</span><span class="va">msg_handler</span><span class="op">)</span></span></code></pre></div>
</div>
</section></section></section></section><section class="level2"><h2 id="static-block-annotations">Asset annotation<a class="anchor" aria-label="anchor" href="#static-block-annotations"></a>
</h2>
<p>There are two ways to serve static content in plumber2 and they differ in subtle ways. The <code>@assets</code> tag instruct plumber to create a regular handler that matches the mount path (defaults to <code>/</code>) and will serve files from <code>Path</code>. The <code>@statics</code> tag works the same, but rather than create a handler it instructs httpuv (which is the low-level package powering plumber2) to serve the files before the request even reaches the R process. This makes it much faster but also limited in flexibility since the request never reaches your code and you are unable to modify it. In general, you should use <code>@statics</code> unless you need to provide any additional handling of the request, such as authentication or logging.</p>
<table class="table caption-top">
<thead><tr class="header">
<th>Annotation</th>
<th>Arguments</th>
<th>Description/References</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>@assets</code></td>
<td>
<code>Path</code> [<code>Mount path</code>]</td>
<td><a href="./routing-and-input.html#static-file-handler">Static files</a></td>
</tr>
<tr class="even">
<td><code>@statics</code></td>
<td>
<code>Path</code> [<code>Mount path</code>]</td>
<td></td>
</tr>
<tr class="odd">
<td><code>@except</code></td>
<td><code>Path</code></td>
<td>Can be used together with <code>@statics</code> to exclude subpaths of the <code>@statics</code> <code>Path</code> from being served.</td>
</tr>
</tbody>
</table>
<section class="level5"><h5 id="annotations-example-6">Annotations example<a class="anchor" aria-label="anchor" href="#annotations-example-6"></a>
</h5>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#* @assets ./assets/files</span></span>
<span><span class="cn">NULL</span></span>
<span></span>
<span><span class="co">#* @assets ./assets/files /assets</span></span>
<span><span class="cn">NULL</span></span>
<span></span>
<span><span class="co">#* @statics ./assets/static_files</span></span>
<span><span class="co">#* @except /secret_files</span></span>
<span><span class="cn">NULL</span></span></code></pre></div>
</section><section class="level5"><h5 id="equivalent-programmatic-usage-note-that-argument-order-is-reversed">Equivalent programmatic usage (note that argument order is reversed)<a class="anchor" aria-label="anchor" href="#equivalent-programmatic-usage-note-that-argument-order-is-reversed"></a>
</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api.html">api</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="../reference/api_assets.html">api_assets</a></span><span class="op">(</span><span class="st">"/"</span>, <span class="st">"./assets/files"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/api.html">api</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="../reference/api_assets.html">api_assets</a></span><span class="op">(</span><span class="st">"/assets"</span>, <span class="st">"./assets/files"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/api.html">api</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="../reference/api_assets.html">api_statics</a></span><span class="op">(</span><span class="st">"/"</span>, <span class="st">"./assets/static_files"</span>, except <span class="op">=</span> <span class="st">"/secret_files"</span><span class="op">)</span></span></code></pre></div>
</div>
</section></section><section class="level2"><h2 id="plumber-block-annotations">plumber2 annotation<a class="anchor" aria-label="anchor" href="#plumber-block-annotations"></a>
</h2>
<table class="table caption-top">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 47%">
</colgroup>
<thead><tr class="header">
<th>Annotation</th>
<th>Arguments</th>
<th>Description/References</th>
</tr></thead>
<tbody><tr class="odd">
<td><code>@plumber</code></td>
<td>None</td>
<td>Modify plumber router from plumber file. If the function returns a plumber2 api object then this object will be used going forward, otherwise the return value is ignored. In most cases, anonymous functions are used following the <code>#* @plumber</code> annotation. However, named functions can also be used. When a named function is used, it must be referenced without parentheses.</td>
</tr></tbody>
</table>
<section class="level5"><h5 id="annotations-example-7">Annotations example<a class="anchor" aria-label="anchor" href="#annotations-example-7"></a>
</h5>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#* @plumber</span></span>
<span><span class="kw">function</span><span class="op">(</span><span class="va">api</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">api</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu"><a href="../reference/api_docs.html">api_doc_setting</a></span><span class="op">(</span><span class="st">"swagger"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Named function</span></span>
<span><span class="va">use_swagger</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">api</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">api</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu"><a href="../reference/api_docs.html">api_doc_setting</a></span><span class="op">(</span><span class="st">"swagger"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#* @plumber</span></span>
<span><span class="va">use_swagger</span></span></code></pre></div>
</section><section class="level5"><h5 id="equivalent-programmatic-usage-6">Equivalent programmatic usage<a class="anchor" aria-label="anchor" href="#equivalent-programmatic-usage-6"></a>
</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api.html">api</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/api_docs.html">api_doc_setting</a></span><span class="op">(</span><span class="st">"swagger"</span><span class="op">)</span></span></code></pre></div>
</div>
</section></section><section class="level2"><h2 id="forwards-and-redirects">Forwards and redirects<a class="anchor" aria-label="anchor" href="#forwards-and-redirects"></a>
</h2>
<p>plumber2 allows you to orchestrate requests that are ultimately handled elsewhere. There are two approaches to this. Either return a redirect response and let the client follow that to the new location, or handle it directly by forwarding the request to another origin and passing along the response to the client (this is called a reverse proxy). Both of these are considered somewhat advanced use.</p>
<table class="table caption-top">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 47%">
</colgroup>
<thead><tr class="header">
<th>Annotation</th>
<th>Arguments</th>
<th>Description/References</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>@redirect</code></td>
<td>[!]<code>Method</code> <code>From</code> <code>To</code>
</td>
<td>Will add a redirect response for the method given as <code>Method</code> from the path given in <code>From</code> to the path given in <code>To</code>. Path parameters are supported and will be matched between <code>Trom</code> and <code>To</code>. If the method is preceded by a <code>!</code> then the redirect is considered permanent (308) — otherwise it is considered temporary (307)</td>
</tr>
<tr class="even">
<td><code>@forward</code></td>
<td>
<code>Path</code> <code>URL</code>
</td>
<td>Will forward requests from <code>Path</code> to <code>URL</code>, acting as a reverse proxy. The proxy will also forward any WebSocket messaging that is established with <code>Path</code>. All forwarding is performed asynchronously so the api will not block if the URL takes a long time to respond.</td>
</tr>
</tbody>
</table>
<section class="level5"><h5 id="annotation-example">Annotation example<a class="anchor" aria-label="anchor" href="#annotation-example"></a>
</h5>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#* @redirect !any old/&lt;path&gt; new/&lt;path&gt;</span></span>
<span><span class="co">#* @redirect get main/&lt;path&gt; temp/main/&lt;path&gt;</span></span>
<span><span class="cn">NULL</span></span>
<span></span>
<span><span class="co">#* @forward proxy/server http://127.0.0.1:56789</span></span>
<span><span class="cn">NULL</span></span></code></pre></div>
</section><section class="level5"><h5 id="equivalent-programmatic-usage-7">Equivalent programmatic usage<a class="anchor" aria-label="anchor" href="#equivalent-programmatic-usage-7"></a>
</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api.html">api</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/api_redirect.html">api_redirect</a></span><span class="op">(</span><span class="st">"any"</span>, <span class="st">"old/&lt;path&gt;"</span>, <span class="st">"new/&lt;path&gt;"</span>, permanent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/api_redirect.html">api_redirect</a></span><span class="op">(</span><span class="st">"get"</span>, <span class="st">"main/*"</span>, <span class="st">"temp/main/*"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/api_forward.html">api_forward</a></span><span class="op">(</span><span class="st">"proxy/server"</span>, <span class="st">"http://127.0.0.1:56789"</span><span class="op">)</span></span></code></pre></div>
</div>
</section></section><section class="level2"><h2 id="shiny">Shiny<a class="anchor" aria-label="anchor" href="#shiny"></a>
</h2>
<p>plumber2 can serve one or more shiny apps at specified paths. It works by launching the shiny app defined below the block in a separate process and then forward requests to the defined path to the process. The shiny app is automatically launched and stopped along with the main plumber2 api.</p>
<table class="table caption-top">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 47%">
</colgroup>
<thead><tr class="header">
<th>Annotation</th>
<th>Arguments</th>
<th>Description/References</th>
</tr></thead>
<tbody><tr class="odd">
<td><code>@shiny</code></td>
<td><code>Path</code></td>
<td>Launc the app defined below the annotation block and forward requests to <code>Path</code> to it</td>
</tr></tbody>
</table>
<section class="level5"><h5 id="annotation-example-1">Annotation example<a class="anchor" aria-label="anchor" href="#annotation-example-1"></a>
</h5>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#* @shiny app/</span></span>
<span><span class="fu">shinyAppDir</span><span class="op">(</span><span class="st">"path/to/shiny/app"</span><span class="op">)</span></span></code></pre></div>
</section><section class="level5"><h5 id="equivalent-programmatic-usage-8">Equivalent programmatic usage<a class="anchor" aria-label="anchor" href="#equivalent-programmatic-usage-8"></a>
</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api.html">api</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/api_shiny.html">api_shiny</a></span><span class="op">(</span><span class="st">"app/"</span>, <span class="fu">shinyAppDir</span><span class="op">(</span><span class="st">"path/to/shiny/app"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</section></section><section class="level2"><h2 id="reports">Reports<a class="anchor" aria-label="anchor" href="#reports"></a>
</h2>
<p>plumber2 can automatically serve Rmarkdown and Quarto reports. The report will be rendered upon request but cached for the future. Different output formats can be selected through the <code>Content-Type</code> request header as long as a matching format is specified in the reports yaml header. Query parameters are automatically passed in as parameters to the report to support parameterized reports natively. Reports can be annotated just like standard request handlers to have OpenAPI documentation generated for it. Rendering is performed asynchronously so the api is not blocked by someone requesting a report that takes a while to render</p>
<table class="table caption-top">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 47%">
</colgroup>
<thead><tr class="header">
<th>Annotation</th>
<th>Arguments</th>
<th>Description/References</th>
</tr></thead>
<tbody><tr class="odd">
<td><code>@report</code></td>
<td><code>Path</code></td>
<td>Serve a report given by the path specified below the annotation block from <code>Path</code>. The report location is relative to the path of the annotation file</td>
</tr></tbody>
</table>
<section class="level5"><h5 id="annotation-example-2">Annotation example<a class="anchor" aria-label="anchor" href="#annotation-example-2"></a>
</h5>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#* Access the quarterly report</span></span>
<span><span class="co">#*</span></span>
<span><span class="co">#* @query quarter:enum|spring, summer, autumn, winter| The quarter to generate the report for</span></span>
<span><span class="co">#*</span></span>
<span><span class="co">#* @report quarterly/</span></span>
<span><span class="st">"my_amazing_report.qmd"</span></span></code></pre></div>
</section><section class="level5"><h5 id="equivalent-programmatic-usage-9">Equivalent programmatic usage<a class="anchor" aria-label="anchor" href="#equivalent-programmatic-usage-9"></a>
</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api.html">api</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/api_add_route.html">api_add_route</a></span><span class="op">(</span><span class="fu">routr</span><span class="fu">::</span><span class="fu"><a href="https://routr.data-imaginist.com/reference/report_route.html" class="external-link">report_route</a></span><span class="op">(</span><span class="st">"quarterly/"</span>, <span class="st">"my_amazing_report.qmd"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Note that the programmatic usage doesn’t add any documentation by itself</p>
</section></section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Lin Pedersen, Posit Software, PBC.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
