<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Annotations reference • plumber2</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Annotations reference">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">plumber2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/quickstart.html">1. Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/routing-and-input.html">2. Routing &amp; Input</a></li>
    <li><a class="dropdown-item" href="../articles/rendering-output.html">3. Rendering output</a></li>
    <li><a class="dropdown-item" href="../articles/execution-model.html">4. Runtime</a></li>
    <li><a class="dropdown-item" href="../articles/hosting.html">5. Hosting</a></li>
    <li><a class="dropdown-item" href="../articles/programmatic-usage.html">6. Programmatic usage</a></li>
    <li><a class="dropdown-item" href="../articles/annotations.html">7. Annotation Reference</a></li>
    <li><a class="dropdown-item" href="../articles/security.html">8. Security</a></li>
    <li><a class="dropdown-item" href="../articles/tips-and-tricks.html">9. Tips &amp; Tricks</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Annotations reference</h1>
            
      

      <div class="d-none name"><code>annotations.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="annotations">Annotations<a class="anchor" aria-label="anchor" href="#annotations"></a>
</h2>
<p>Annotations are specially-structured comments used in your plumber
file to create an API. A full annotation line starts with
<code>#*</code>, then the annotation keyword <code>@...</code>, any
number of space characters followed by the content. If you wish to use
the annotation to document your API file but don’t want any OpenAPI
documentation to be generated you can use <code>@noDoc</code> tag which
works much like roxygens <code>@noRd</code>.</p>
</div>
<div class="section level2">
<h2 id="global-annotations">Global annotations<a class="anchor" aria-label="anchor" href="#global-annotations"></a>
</h2>
<p>Global annotations are not related to any handler and should be
placed in their own block. The block should be terminated by a
<code>NULL</code> expression. Instead of <code>@apiTitle</code> and
<code>@apiDescription</code> you can also use the convention that the
first line gives the title and any proceeding lines until the first tag
gives the description.</p>
<table class="table">
<colgroup>
<col width="26%">
<col width="26%">
<col width="47%">
</colgroup>
<thead><tr class="header">
<th>Annotation</th>
<th>Argument</th>
<th>Description/References</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>@apiTitle</code></td>
<td><code>Title</code></td>
<td><a href="http://spec.openapis.org/oas/v3.0.3#info-object" class="external-link">Info
Object</a></td>
</tr>
<tr class="even">
<td><code>@apiDescription</code></td>
<td><code>Description</code></td>
<td><a href="http://spec.openapis.org/oas/v3.0.3#info-object" class="external-link">Info
Object</a></td>
</tr>
<tr class="odd">
<td><code>@apiTOS</code></td>
<td><code>TOS link</code></td>
<td><a href="http://spec.openapis.org/oas/v3.0.3#info-object" class="external-link">Info
Object</a></td>
</tr>
<tr class="even">
<td><code>@apiContact</code></td>
<td><code>Contact object</code></td>
<td><a href="http://spec.openapis.org/oas/v3.0.3#contact-object" class="external-link">Contact
Object</a></td>
</tr>
<tr class="odd">
<td><code>@apiLicense</code></td>
<td><code>License object</code></td>
<td><a href="http://spec.openapis.org/oas/v3.0.3#license-object" class="external-link">License
Object</a></td>
</tr>
<tr class="even">
<td><code>@apiVersion</code></td>
<td><code>Version</code></td>
<td><a href="http://spec.openapis.org/oas/v3.0.3#info-object" class="external-link">Info
Object</a></td>
</tr>
<tr class="odd">
<td><code>@apiTag</code></td>
<td>
<code>Tag</code> <code>Description</code>
</td>
<td>Can be repeated to add multiple tags. Quote with ” or ’ to use non
word character (like spaces) in <code>Tag</code>. <a href="http://spec.openapis.org/oas/v3.0.3#tag-object" class="external-link">Tag
Object</a>
</td>
</tr>
</tbody>
</table>
<div class="section level5">
<h5 id="annotations-example">Annotations example<a class="anchor" aria-label="anchor" href="#annotations-example"></a>
</h5>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#* Sample Pet Store App</span></span>
<span><span class="co">#*</span></span>
<span><span class="co">#* This is a sample server for a pet store.</span></span>
<span><span class="co">#*</span></span>
<span><span class="co">#* @apiTOS http://example.com/terms/</span></span>
<span><span class="co">#* @apiContact list(name = "API Support", url = "http://www.example.com/support", email = "support@example.com")</span></span>
<span><span class="co">#* @apiLicense list(name = "Apache 2.0", url = "https://www.apache.org/licenses/LICENSE-2.0.html")</span></span>
<span><span class="co">#* @apiVersion 1.0.1</span></span>
<span><span class="co">#* @apiTag pet Pets operations</span></span>
<span><span class="co">#* @apiTag toy Toys operations</span></span>
<span><span class="co">#* @apiTag "toy space" Toys operations</span></span>
<span><span class="cn">NULL</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="equivalent-programmatic-usage">Equivalent programmatic usage<a class="anchor" aria-label="anchor" href="#equivalent-programmatic-usage"></a>
</h5>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api.html">api</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/api_docs.html">api_doc_add</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      title <span class="op">=</span> <span class="st">"Sample Pet Store App"</span>,</span>
<span>      description <span class="op">=</span> <span class="st">"This is a sample server for a pet store."</span>,</span>
<span>      termsOfService <span class="op">=</span> <span class="st">"http://example.com/terms/"</span>,</span>
<span>      contact <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"API Support"</span>, url <span class="op">=</span> <span class="st">"http://www.example.com/support"</span>, email <span class="op">=</span> <span class="st">"support@example.com"</span><span class="op">)</span>,</span>
<span>      license <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Apache 2.0"</span>, url <span class="op">=</span> <span class="st">"https://www.apache.org/licenses/LICENSE-2.0.html"</span><span class="op">)</span>,</span>
<span>      version <span class="op">=</span> <span class="st">"1.0.1"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    tags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"pet"</span>, description <span class="op">=</span> <span class="st">"Pets operations"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"toy"</span>, description <span class="op">=</span> <span class="st">"Toys operations"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"toy space"</span>, description <span class="op">=</span> <span class="st">"Toys operations"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## ── A plumber server ────────────────────────────────────────────────────────────</span></span>
<span><span class="co">## Serving on http://127.0.0.1:8080</span></span>
<span><span class="co">## Currently <span style="color: #BB0000;">not running</span></span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="handler-annotations">Handler annotations<a class="anchor" aria-label="anchor" href="#handler-annotations"></a>
</h2>
<p>Handler annotation describe all aspects of a request handler and
always proceeds a function which is considered the handler function. The
following tags can be used in a handler block. The first line, unless it
has a tag is considered the title of the handler and any proceeding
lines until the first tag is considered a long-form description.</p>
<div class="section level3">
<h3 id="endpoint-block-annotations">Endpoint<a class="anchor" aria-label="anchor" href="#endpoint-block-annotations"></a>
</h3>
<table style="width:92%;" class="table">
<colgroup>
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 43%">
</colgroup>
<thead><tr class="header">
<th>
<p>
Annotation
</p>
</th>
<th>
<p>
Argument
</p>
</th>
<th>
<p>
Description/References
</p>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>
<p>
<code><span class="citation">@get</span></code>, <code><span class="citation">@head</span></code>, <code><span class="citation">@post</span></code>, <code><span class="citation">@put</span></code>, <code><span class="citation">@delete</span></code>, <code><span class="citation">@connect</span></code>, <code><span class="citation">@options</span></code>, <code><span class="citation">@trace</span></code>, <code><span class="citation">@patch</span></code>, <code><span class="citation">@any</span></code>
</p>
</td>
<td>
<p>
<code>Path</code>
</p>
</td>
<td>
<p>
<a href="./routing-and-input.html#endpoints">Endpoints</a>,
<a href="./routing-and-input.html#dynamic-routes">Dynamic Routes</a>,
<a href="./routing-and-input.html#typed-dynamic-routes">Typed Dynamic
Routes</a>
</p>
</td>
</tr>
<tr class="even">
<td>
<p>
<code><span class="citation">@header</span></code>
</p>
</td>
<td>
<p>
None
</p>
</td>
<td>
<p>
Should the handler be attached to the header router
</p>
</td>
</tr>
<tr class="odd">
<td>
<p>
<code><span class="citation">@serializer</span></code>
</p>
</td>
<td>
<p>
<code>Alias</code>[<code>{Args list]}</code>]
</p>
<p>
<code>Mime</code> <code>Function</code>
</p>
</td>
<td>
<p>
Some serializers accept arguments. See
<a href="./rendering-output.html#serializers">serializers article</a>
and
<a href="https://www.rplumber.io/reference/serializers.html" class="external-link">serializers
reference</a>. Aliases : <code>r paste0(“&lt;code&gt;”,
registered_serializers(), “&lt;/code&gt;”, collapse = “,”)</code> from
<a href="https://www.rplumber.io/reference/register_serializer.html" class="external-link"><code>registered_serializers()</code></a>.
</p>
</td>
</tr>
<tr class="even">
<td>
<p>
<code><span class="citation">@serializerStrict</span></code>
</p>
</td>
<td>
<p>
None
</p>
</td>
<td>
<p>
Turn on strict content negotiation. By default, the first serializer is
chosen if the client requests a response type that isnt supported. By
using strict content negotiation a 406 response is sent if the requested
response type is not available
</p>
</td>
</tr>
<tr class="odd">
<td>
<p>
<code><span class="citation">@parser</span></code>
</p>
</td>
<td>
<p>
<code>Alias</code>[<code>{Args list}</code>]
</p>
<p>
<code>Mime</code> <code>Function</code>
</p>
</td>
<td>
<p>
Some parsers accept arguments. See
<a href="https://www.rplumber.io/reference/parsers.html" class="external-link">parsers
reference</a>. Can be repeated to allow multiple parsers on the same
endpoint. Aliases : <code>r paste0(“&lt;code&gt;”, registered_parsers(),
“&lt;/code&gt;”, collapse = “,”)</code> from
<a href="https://www.rplumber.io/reference/register_parser.html" class="external-link"><code>registered_parsers()</code></a>.
</p>
</td>
</tr>
<tr class="even">
<td>
<p>
<code><span class="citation">@param</span></code>, <code><span class="citation">@query</span></code>, <code><span class="citation">@body</span></code>
</p>
</td>
<td>
<p>
<code>Name</code>[<code>:Type</code>][<code>(Default)</code>][<code>*</code>][<code>Description</code>]
</p>
</td>
<td>
<p>
Adding an asterix indicates that the parameter is required. Can be
repeated to define different parameters. If a single <code><span class="citation">@body</span></code> tag is used the <code>Name</code>
can be omitted to indicate that the body is not a named object but
simply an instance of the given <code>Type</code>
</p>
</td>
</tr>
<tr class="odd">
<td>
<p>
<code><span class="citation">@response</span></code>
</p>
</td>
<td>
<p>
<code>Status</code>[<code>:Type</code>] <code>Description</code>
</p>
</td>
<td>
<p>
Simple
<a href="http://spec.openapis.org/oas/v3.0.3#response-object" class="external-link">Response
object</a>. Can be repeated to define different responses.
</p>
</td>
</tr>
<tr class="even">
<td>
<p>
<code><span class="citation">@download</span></code>
</p>
</td>
<td>
<p>
[<code>Filename</code>]
</p>
</td>
<td>
<p>
Mark the response as something that should be downloaded, optionally
setting a default filename for the file
</p>
</td>
</tr>
<tr class="odd">
<td>
<p>
<code><span class="citation">@tag</span></code>
</p>
</td>
<td>
<p>
<code>Tag</code>
</p>
</td>
<td>
<p>
Can be repeated to add multiple tags. Quote with or to use non word
character (like spaces) in <code>Tag</code>.
<a href="http://spec.openapis.org/oas/v3.0.3#operation-object" class="external-link">Tag
field</a>
</p>
</td>
</tr>
<tr class="even">
<td>
<p>
<code><span class="citation">@message</span></code>
</p>
</td>
<td>
<p>
None
</p>
</td>
<td>
<p>
Marks the handler as a WebSocket message handler. No other tags will
have an effect if this tag is present
</p>
</td>
</tr>
</tbody>
</table>
<div class="section level4">
<h4 id="more-details-on-type">More details on <code>Type</code><a class="anchor" aria-label="anchor" href="#more-details-on-type"></a>
</h4>
<p>Types are used to define API inputs and outputs. For path parameters
they can be given both in <code>@param</code> and inside the handler
path. If they are given both places they <strong>must</strong> be in
agreement. For query and body parameters they are given in their
respective <code>@query</code> and <code>@body</code> tags.</p>
<p>Some types can have a nested structure which is also supported, but
the type spec can quickly become difficult to read the further you
recurse so use with care</p>
<table class="table">
<colgroup>
<col width="44%">
<col width="55%">
</colgroup>
<thead><tr class="header">
<th>Type</th>
<th>OpenAPI</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>boolean</code></td>
<td><code>boolean</code></td>
</tr>
<tr class="even">
<td><code>number</code></td>
<td><code>number</code></td>
</tr>
<tr class="odd">
<td><code>integer</code></td>
<td><code>integer</code></td>
</tr>
<tr class="even">
<td><code>string</code></td>
<td><code>string</code></td>
</tr>
<tr class="odd">
<td><code>date</code></td>
<td>
<code>string</code> <code>format:date</code>
</td>
</tr>
<tr class="even">
<td><code>date-time</code></td>
<td>
<code>string</code> <code>format:date-time</code>
</td>
</tr>
<tr class="odd">
<td><code>byte</code></td>
<td>
<code>string</code> <code>format:byte</code>
</td>
</tr>
<tr class="even">
<td><code>binary</code></td>
<td>
<code>string</code> <code>format:binary</code>
</td>
</tr>
<tr class="odd">
<td><code>[Type]</code></td>
<td>
<code>array</code> <code>items:type:Type</code>
</td>
</tr>
<tr class="even">
<td><code>{prop_name: Type, prop_name2: Type2}</code></td>
<td>
<code>object</code> <code>properties:prop_name:type:Type</code>
<code>properties:prop_name2:type:Type2</code>
</td>
</tr>
</tbody>
</table>
<p>Types can have a default value, which is given in parentheses after
the type specification, e.g. <code>integer(10)</code>. For objects and
arrays you should use JSON notation to describe the default value
(e.g. <code>[integer]([2, 6, 1])</code>).</p>
<p>parameters can be specified as optional or required in their type
notation. Path parameters are always required so any setting is ignored
for this. A parameter can be marked as required by adding a
<code>*</code> suffix to the type description,
e.g. <code>arg1:integer*</code> to indicate that <code>arg1</code> is
required and an integer. A parameter cannot both be required and have a
default value (for reasons of logic).</p>
<p>Apart from being used in the documentation of your API, the type
information you provide for parameters will also be used to cast the
incoming values to the correct type and add defaults if missing.
Further, missing required parameters will result in an error. The
response is not type checked so it is up to you to conform with the
specification you provide.</p>
<div class="section level5">
<h5 id="annotations-example-1">Annotations example<a class="anchor" aria-label="anchor" href="#annotations-example-1"></a>
</h5>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#* @get /query/parameters</span></span>
<span><span class="co">#* @serializer text</span></span>
<span><span class="co">#* @query name:string*</span></span>
<span><span class="co">#* @query age:integer*</span></span>
<span><span class="kw">function</span><span class="op">(</span><span class="va">query</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s is %i years old"</span>, <span class="va">query</span><span class="op">$</span><span class="va">name</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">query</span><span class="op">$</span><span class="va">age</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#* @get /dyn/&lt;name:string&gt;/&lt;age:integer&gt;/route</span></span>
<span><span class="co">#* @serializer text</span></span>
<span><span class="co">#* @parser none</span></span>
<span><span class="co">#* @response 200:string A sentence</span></span>
<span><span class="kw">function</span><span class="op">(</span><span class="va">name</span>, <span class="va">age</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s is %i years old"</span>, <span class="va">name</span>, <span class="va">age</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#* Upload a file and return the object as an rds</span></span>
<span><span class="co">#*</span></span>
<span><span class="co">#* @post /upload_file</span></span>
<span><span class="co">#* @serializer rds</span></span>
<span><span class="co">#* @parser multi</span></span>
<span><span class="co">#* @body file:binary A file</span></span>
<span><span class="co">#* @download</span></span>
<span><span class="kw">function</span><span class="op">(</span><span class="va">body</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">body</span><span class="op">$</span><span class="va">file</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#* @message</span></span>
<span><span class="kw">function</span><span class="op">(</span><span class="va">message</span>, <span class="va">client_id</span>, <span class="va">server</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character</a></span><span class="op">(</span><span class="va">message</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">server</span><span class="op">$</span><span class="fu">log</span><span class="op">(</span><span class="st">"message"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">client_id</span>, <span class="st">" says "</span>, <span class="va">message</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="cn">NULL</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="equivalent-programmatic-usage-1">Equivalent programmatic usage<a class="anchor" aria-label="anchor" href="#equivalent-programmatic-usage-1"></a>
</h5>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">text_handler</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">name</span>, <span class="va">age</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s is %i years old"</span>, <span class="va">name</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">qp_handler</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">query</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">text_handler</span><span class="op">(</span><span class="va">query</span><span class="op">$</span><span class="va">name</span>, <span class="va">query</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">file_handler</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">body</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">body</span><span class="op">$</span><span class="va">f</span></span>
<span><span class="op">}</span></span>
<span><span class="va">msg_handler</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">message</span>, <span class="va">client_id</span>, <span class="va">server</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character</a></span><span class="op">(</span><span class="va">message</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">server</span><span class="op">$</span><span class="fu">log</span><span class="op">(</span><span class="st">"message"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">client_id</span>, <span class="st">" says "</span>, <span class="va">message</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="cn">NULL</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="../reference/api.html">api</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/api_request_handlers.html">api_get</a></span><span class="op">(</span></span>
<span>    path <span class="op">=</span> <span class="st">"/query/parameters"</span>,</span>
<span>    handler <span class="op">=</span> <span class="va">qp_handler</span>,</span>
<span>    serializers <span class="op">=</span> <span class="fu"><a href="../reference/register_serializer.html">get_serializers</a></span><span class="op">(</span><span class="st">"text"</span><span class="op">)</span>,</span>
<span>    parsers <span class="op">=</span> <span class="fu"><a href="../reference/register_parser.html">get_parsers</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    doc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>          `in` <span class="op">=</span> <span class="st">"query"</span>,</span>
<span>          name <span class="op">=</span> <span class="st">"name"</span>,</span>
<span>          schema <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"string"</span><span class="op">)</span>,</span>
<span>          required <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>        <span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>          `in` <span class="op">=</span> <span class="st">"query"</span>,</span>
<span>          name <span class="op">=</span> <span class="st">"age"</span>,</span>
<span>          schema <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"integer"</span><span class="op">)</span>,</span>
<span>          required <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/api_request_handlers.html">api_get</a></span><span class="op">(</span></span>
<span>    path <span class="op">=</span> <span class="st">"/dyn/&lt;name:string&gt;/&lt;age:integer&gt;/route"</span>,</span>
<span>    handler <span class="op">=</span> <span class="va">text_handler</span>,</span>
<span>    serializers <span class="op">=</span> <span class="fu"><a href="../reference/register_serializer.html">get_serializers</a></span><span class="op">(</span><span class="st">"text"</span><span class="op">)</span>,</span>
<span>    doc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      responses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>         <span class="st">"200"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>          description <span class="op">=</span> <span class="st">"A sentence"</span>,</span>
<span>          content <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>            <span class="st">"text/plain"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>schema <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>              type <span class="op">=</span> <span class="st">"string"</span></span>
<span>            <span class="op">)</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/api_request_handlers.html">api_post</a></span><span class="op">(</span></span>
<span>    path <span class="op">=</span> <span class="st">"/upload_file"</span>,</span>
<span>    handler <span class="op">=</span> <span class="va">file_handler</span>,</span>
<span>    serializers <span class="op">=</span> <span class="fu"><a href="../reference/register_serializer.html">get_serializers</a></span><span class="op">(</span><span class="st">"rds"</span><span class="op">)</span>,</span>
<span>    parsers <span class="op">=</span> <span class="fu"><a href="../reference/register_parser.html">get_parsers</a></span><span class="op">(</span><span class="st">"multi"</span><span class="op">)</span>,</span>
<span>    doc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      description <span class="op">=</span> <span class="st">"Upload an rds file and return the object"</span>,</span>
<span>      requestBody <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        content <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>          <span class="st">"multipart/form-data"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>schema <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>            type <span class="op">=</span> <span class="st">"object"</span>,</span>
<span>            properties <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>              file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                type <span class="op">=</span> <span class="st">"string"</span>,</span>
<span>                format <span class="op">=</span> <span class="st">"binary"</span></span>
<span>              <span class="op">)</span></span>
<span>            <span class="op">)</span></span>
<span>          <span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/api_message.html">api_message</a></span><span class="op">(</span><span class="va">msg_handler</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Creating <span style="color: #00BB00;">default</span> route in request router</span></span></code></pre>
<pre><code><span><span class="co">## ── A plumber server ────────────────────────────────────────────────────────────</span></span>
<span><span class="co">## Serving on http://127.0.0.1:8080</span></span>
<span><span class="co">## Currently <span style="color: #BB0000;">not running</span></span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="static-block-annotations">Asset annotation<a class="anchor" aria-label="anchor" href="#static-block-annotations"></a>
</h2>
<p>There are two ways to serve static content in plumber2 and they
differ in subtle ways. The <code>@assets</code> tag instruct plumber to
create a regular handler that matches the mount path (defaults to
<code>/</code>) and will serve files from <code>Path</code>. The
<code>@statics</code> tag works the same, but rather than create a
handler it instructs httpuv (which is the low-level package powering
plumber2) to serve the files before the request even reaches the R
process. This makes it much faster but also limited in flexibility since
the request never reaches your code and you are unable to modify it. In
general, you should use <code>@statics</code> unless you need to provide
any additional handling of the request, such as authentication or
logging.</p>
<table class="table">
<colgroup>
<col width="26%">
<col width="26%">
<col width="47%">
</colgroup>
<thead><tr class="header">
<th>Annotation</th>
<th>Arguments</th>
<th>Description/References</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>@assets</code></td>
<td>
<code>Path</code> <span class="math display">$$`Mount
path`$$</span>
</td>
<td><a href="./routing-and-input.html#static-file-handler">Static
files</a></td>
</tr>
<tr class="even">
<td><code>@statics</code></td>
<td>
<code>Path</code> <span class="math display">$$`Mount
path`$$</span>
</td>
<td></td>
</tr>
<tr class="odd">
<td><code>@except</code></td>
<td><code>Path</code></td>
<td>Can be used together with <code>@statics</code> to exclude subpaths
of the <code>@statics</code> <code>Path</code> from being served.</td>
</tr>
</tbody>
</table>
<div class="section level5">
<h5 id="annotations-example-2">Annotations example<a class="anchor" aria-label="anchor" href="#annotations-example-2"></a>
</h5>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#* @assets ./assets/files</span></span>
<span><span class="cn">NULL</span></span>
<span></span>
<span><span class="co">#* @assets ./assets/files /assets</span></span>
<span><span class="cn">NULL</span></span>
<span></span>
<span><span class="co">#* @statics ./assets/static_files</span></span>
<span><span class="co">#* @except /secret_files</span></span>
<span><span class="cn">NULL</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="equivalent-programmatic-usage-note-that-argument-order-is-reversed">Equivalent programmatic usage (note that argument order is
reversed)<a class="anchor" aria-label="anchor" href="#equivalent-programmatic-usage-note-that-argument-order-is-reversed"></a>
</h5>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api.html">api</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="../reference/api_assets.html">api_assets</a></span><span class="op">(</span><span class="st">"/"</span>, <span class="st">"./assets/files"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/api.html">api</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="../reference/api_assets.html">api_assets</a></span><span class="op">(</span><span class="st">"/assets"</span>, <span class="st">"./assets/files"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/api.html">api</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="../reference/api_assets.html">api_statics</a></span><span class="op">(</span><span class="st">"/"</span>, <span class="st">"./assets/static_files"</span>, except <span class="op">=</span> <span class="st">"/secret_files"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="plumber-block-annotations">Plumber annotation<a class="anchor" aria-label="anchor" href="#plumber-block-annotations"></a>
</h2>
<table class="table">
<colgroup>
<col width="26%">
<col width="26%">
<col width="47%">
</colgroup>
<thead><tr class="header">
<th>Annotation</th>
<th>Arguments</th>
<th>Description/References</th>
</tr></thead>
<tbody><tr class="odd">
<td><code>@plumber</code></td>
<td>None</td>
<td>Modify plumber router from plumber file. The plumber router provided
to the function <strong>must</strong> be returned. In most cases,
anonymous functions are used following the <code>#* @plumber</code>
annotation. However, named functions can also be used. When a named
function is used, it must be referenced without parentheses.</td>
</tr></tbody>
</table>
<div class="section level5">
<h5 id="annotations-example-3">Annotations example<a class="anchor" aria-label="anchor" href="#annotations-example-3"></a>
</h5>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#* @plumber</span></span>
<span><span class="kw">function</span><span class="op">(</span><span class="va">api</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">api</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu"><a href="../reference/api_docs.html">api_doc_setting</a></span><span class="op">(</span><span class="st">"swagger"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Named function</span></span>
<span><span class="va">use_swagger</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">api</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">api</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu"><a href="../reference/api_docs.html">api_doc_setting</a></span><span class="op">(</span><span class="st">"swagger"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#* @plumber</span></span>
<span><span class="va">use_swagger</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="equivalent-programmatic-usage-2">Equivalent programmatic usage<a class="anchor" aria-label="anchor" href="#equivalent-programmatic-usage-2"></a>
</h5>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api.html">api</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/api_docs.html">api_doc_setting</a></span><span class="op">(</span><span class="st">"swagger"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## ── A plumber server ────────────────────────────────────────────────────────────</span></span>
<span><span class="co">## Serving on http://127.0.0.1:8080</span></span>
<span><span class="co">## Currently <span style="color: #BB0000;">not running</span></span></span></code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Lin Pedersen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
